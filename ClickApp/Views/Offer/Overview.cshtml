@model IEnumerable<ClickApp.ViewModels.OfferViewModel>
@*@using TicketingSystemApp.Services.Interfaces;*@
@*@using TicketingSystemApp.Models;*@
@using Microsoft.AspNetCore.Identity;

@*@inject ITicketsStatusesService _ticketsStatusesService*@
@inject UserManager<ApplicationUser> _userManager;


@{
    ViewData["Title"] = "Offers";
}
@section Styles{
    <link rel="stylesheet" href="~/css/OffersOverview.css" />
}

@*@if (ViewBag.SuccessMessage != null)
    {
        <div class="alert alert-success m-3" role="alert">
            @ViewBag.SuccessMessage
        </div>
    }*@

<p>
    <a asp-action="Create">Create New</a>
</p>

@if (ViewBag.EmptyListMessage != null)
{
    <div class="alert alert-danger m-3" role="alert">
        @ViewBag.EmptyListMessage
    </div>
}
else
{
    <div class="container" id="offerOptionsContainer">
        <div class="row justify-content-center ">
            <div class="col-md-5 text-center">
                <img class="offerOptionImg shadow" src="https://lh3.googleusercontent.com/proxy/EMIM-ZdCDiRXVgJ9je5sDq-Wsezo371NAyHTEErPzgBmu0h3V0qQQDp1_dE5h18PeTFi4TwR5k9cpj9G7OobdVt-tdKsaEXtQTk2X6C55yK-HicOUEEQnNgi6hMJfN9op3KBYuUjCMmfQpRSe221D5-UMlBIYfVoCJ__u6f6Xs1T9YQumMtavy6YceIJvgIqip6wP4dXpy7hRCIWJQsF60V2X74dFY_e" onclick="showProfessionalOffers()" />
                <h2>Professional</h2>
            </div>
            <div class="col-md-5 text-center" onclick="showAmateurOffers()">
                <img class="offerOptionImg shadow" src="https://certifind.com/blog/wp-content/uploads/2017/11/Work-Ethics3.jpg" />
                <h2>Non professional</h2>
            </div>
        </div>
    </div>

    <div class="container bcontent d-none" id="professionalOffersContainer">
        <div class="row justify-content-between">
            @foreach (var offer in @Model.OrderByDescending(x => x.DateCreated).Where(x => x.IsProfessional == true).ToList())
            {

                <div class="card offerCard m-5" style="width: 500px;">
                    <div class="row no-gutters">
                        @if (offer.ImportantNote != null || offer.ImportantNote != "")
                        {
                            <div class="col-sm-12 pl-3">
                                <span class="bg-warning">@offer.ImportantNote</span>
                            </div>
                        }
                        <div class="col-sm-12">
                            <div class="row pl-3">
                                @if (offer.ImageUrl != null || offer.ImageUrl != "")
                                {
                                    <div class="col-sm-3 p-1">
                                        <img class="card offerImg" src="@offer.ImageUrl" alt="Image">
                                    </div>
                                }
                                else
                                {
                                    <div class="col-sm-3 p-1">
                                        <img class="card offerImg" src="https://outofschool.club/wp-content/uploads/2015/02/insert-image-here.jpg" alt="Image">
                                    </div>
                                }
                                <div class="col-sm-7">
                                    <div class="card-body">
                                        <h4>@offer.Title</h4>
                                        <h6 class="card-title">
                                            Date created: @offer.DateCreated. @if (offer.ValidUntil != null)
                                            {<h6>Valid until: @offer.ValidUntil</h6>}
                                        </h6>
                                        @{var userName = _userManager.FindByIdAsync(offer.UserId).Result.Name + " " + _userManager.FindByIdAsync(offer.UserId).Result.LastName; }
                                        <p class="card-text">@userName</p>

                                        <a asp-action="Details" asp-route-id="@offer.Id" class="btn btn-success">See more</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="row justify-content-center">
            <div class="btn btn-success" onclick="returnOfferOptionsContainer()">Return</div>
        </div>
    </div>

    <div class="container bcontent d-none" id="amateurOffersContainer">
        <div class="row justify-content-between">
            @foreach (var offer in @Model.OrderByDescending(x => x.DateCreated).Where(x => x.IsProfessional == false).ToList())
            {

                <div class="card offerCard m-5" style="width: 500px;">
                    <div class="row no-gutters">
                        @if (offer.ImportantNote != null || offer.ImportantNote != "")
                        {
                            <div class="col-sm-12 pl-3">
                                <span class="bg-warning">@offer.ImportantNote</span>
                            </div>
                        }
                        <div class="col-sm-12">
                            <div class="row pl-3">
                                @if (offer.ImageUrl != null || offer.ImageUrl != "")
                                {
                                    <div class="col-sm-3 p-1">
                                        <img class="card offerImg" src="@offer.ImageUrl" alt="Image">
                                    </div>
                                }
                                else
                                {
                                    <div class="col-sm-3 p-1">
                                        <img class="card offerImg" src="https://outofschool.club/wp-content/uploads/2015/02/insert-image-here.jpg" alt="Image">
                                    </div>
                                }
                                <div class="col-sm-7">
                                    <div class="card-body">
                                        <h4>@offer.Title</h4>
                                        <h6 class="card-title">
                                            Date created: @offer.DateCreated. @if (offer.ValidUntil != null)
                                            {<h6>Valid until: @offer.ValidUntil</h6>}
                                        </h6>
                                        @{var userName = _userManager.FindByIdAsync(offer.UserId).Result.Name + " " + _userManager.FindByIdAsync(offer.UserId).Result.LastName; }
                                        <p class="card-text">@userName</p>

                                        <a asp-action="Details" asp-route-id="@offer.Id" class="btn btn-success">See more</a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
        <div class="row justify-content-center">
            <div class="btn btn-success" onclick="returnOfferOptionsContainer()">Return</div>
        </div>
    </div>
}


@section Scripts{
    <script>

        function showContainer(containerId) {
            var container = document.getElementById(containerId);
            container.classList.remove("d-none");
            container.classList.add("d-block");
        }
        function hideContainer(containerId) {
            var container = document.getElementById(containerId);
            container.classList.remove("d-block");
            container.classList.add("d-none");
        }
        function showProfessionalOffers() {
            hideContainer("offerOptionsContainer");
            hideContainer("amateurOffersContainer");
            showContainer("professionalOffersContainer");
        }
        function showAmateurOffers() {
            hideContainer("offerOptionsContainer");
            hideContainer("professionalOffersContainer");
            showContainer("amateurOffersContainer");
        }
        function returnOfferOptionsContainer() {
            showContainer("offerOptionsContainer");
            hideContainer("professionalOffersContainer");
            hideContainer("amateurOffersContainer");
        }
    </script>
}
